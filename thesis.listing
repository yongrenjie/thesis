from contextlib import contextmanager

@contextmanager
def pidfile():
    # Create a file with the PID
    pid = os.getpid()
    pid_fname = Path(__file__).parent / f".pid{pid}"
    pid_fname.touch()
    # Run the code in the 'with' block
    try:
        yield
    # Delete the file after the 'with' block is exited
    finally:
        if pid_fname.exists():
            pid_fname.unlink()

if __name__ == "__main__":
    with pidfile() as _:
        main()
